<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>A logic game</title>

  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/visual.css">

  <script src="https://cdn.jsdelivr.net/npm/d3-require@1"></script>
</head>

<body>

  <h1>A Logic Game</h1>

  <main>
    <div class="visual-container" id="visual-container">
      <div id="visual"></div>
    </div>

    <div class="game-controls">
      <div>
        <button onclick="do_generate()" class="control-button" id="generate-button" disabled>&#x239A; Generate level</button>
        &nbsp;
        <button onclick="clear_level()" class="control-button" id="clear-button" disabled>&#x2717; Clear level</button>
        &nbsp;
        <button onclick="reset_level()" class="control-button" id="reset-button" disabled>&#x21BA; Reset level</button>
        &nbsp;&mdash;&nbsp;
        <button onclick="do_play()" class="control-button" id="play-button" disabled>&#x23F5; Play</button>
        &nbsp;
        <button onclick="do_pause()" class="control-button" id="pause-button" disabled>&#x23F8; Pause</button>
        &nbsp;
        <button onclick="do_stop()" class="control-button" id="stop-button" disabled>&#x23F9; Stop</button>
        &nbsp;&mdash;&nbsp;
        Speed:&nbsp;
        <select id="speed-selector" onchange="select_speed()">
          <option value="1000">Slow</option>
          <option value="5000">Medium</option>
          <option value="200" selected>Fast</option>
          <option value="100">Very fast</option>
        </select>
      </div>
    </div>

    <input id="tab1" type="radio" name="tabs" onChange="change_tabs()" checked>
    <label for="tab1" name="tabs">Control</label>

    <input id="tab2" type="radio" name="tabs" onChange="change_tabs()">
    <label for="tab2" name="tabs">Instructions</label>

    <input id="tab3" type="radio" name="tabs" onChange="change_tabs()">
    <label for="tab3" name="tabs">Game rules</label>

    <input id="tab4" type="radio" name="tabs" onChange="change_tabs()">
    <label for="tab4" name="tabs">Strategy</label>

    <input id="tab5" type="radio" name="tabs" onChange="change_tabs()">
    <label for="tab5" name="tabs">Debug</label>

    <section id="section-control">
      <p>
        Here you can load files, from one of the examples listed
        or from a file on your device.
        You can also download the current game to a file
        on your device.
      </p>

      <p>
        Navigate to the next tabs to read the instructions for how to play,
        to view and edit the game rules,
        and to enter your strategy.
      </p>

      <h3>Load game</h3>
      <select id="example-games">
        <optgroup label="Getting started">
          <option value="examples/flag1.json">Find the flag 1</option>
          <option value="examples/flag1-with-solutions.json">Find the flag 1 (with solution)</option>
          <option value="examples/flag2.json">Find the flag 2</option>
          <option value="examples/flag2-with-solutions.json">Find the flag 2 (with solution)</option>
          <option value="examples/flag3.json">Find the flag 3</option>
          <option value="examples/flag3-with-solutions.json">Find the flag 3 (with solution)</option>
          <option value="examples/flag4.json">Find the flag 4</option>
          <option value="examples/flag4-with-solutions.json">Find the flag 4 (with solution)</option>
          <option value="examples/flag5.json">Find the flag 5</option>
          <option value="examples/flag5-with-solutions.json">Find the flag 5 (with solution)</option>
          <option value="examples/flag6.json">Find the flag 6</option>
          <option value="examples/flag6-with-solutions.json">Find the flag 6 (with solution)</option>
        </optgroup>
        <optgroup label="(More) find the flag">
          <option value="examples/flag7.json">Find the flag 7</option>
        </optgroup>
        <optgroup label="Solutions">
          <option value="examples/flag7-with-solutions.json">Find the flag 7 (with solutions)</option>
        </optgroup>
      </select>
      &nbsp;
      <button onclick="load_game()" class="control-button">Load</button>
      <p id="load-status"></p>

      <h3>Upload game from file</h3>
      <form id="upload-form" enctype="multipart/form-data">
        <label for="file-input" class="control-button">Select file</label>
        <input type="file" id="file-input" onchange="load_game_from_file(event)" required>
      </form>
      <p id="upload-status"></p>

      <h3>Download current game</h3>
      <button onclick="download_game()" class="control-button">Download</button>

    </section>

    <section id="section-instructions">
      <h3>General gameplay</h3>
      <p>
        Arma virumque cano, Troiae qui primus ab oris Italiam, fato profugus, Laviniaque venit litora, multum ille et terris iactatus et alto vi superum saevae memorem Iunonis ob iram; 5multa quoque et bello passus, dum conderet urbem, inferretque deos Latio, genus unde Latinum, Albanique patres, atque altae moenia Romae.
      </p>
      <h3>How are levels generated?</h3>
      <p>
        Arma virumque cano, Troiae qui primus ab oris Italiam, fato profugus, Laviniaque venit litora, multum ille et terris iactatus et alto vi superum saevae memorem Iunonis ob iram; 5multa quoque et bello passus, dum conderet urbem, inferretque deos Latio, genus unde Latinum, Albanique patres, atque altae moenia Romae.
      </p>
      <h3>What can the player observe?</h3>
      <p>
        Arma virumque cano, Troiae qui primus ab oris Italiam, fato profugus, Laviniaque venit litora, multum ille et terris iactatus et alto vi superum saevae memorem Iunonis ob iram; 5multa quoque et bello passus, dum conderet urbem, inferretque deos Latio, genus unde Latinum, Albanique patres, atque altae moenia Romae.
      </p>
      <h3>How does the game progress?</h3>
      <p>
        Arma virumque cano, Troiae qui primus ab oris Italiam, fato profugus, Laviniaque venit litora, multum ille et terris iactatus et alto vi superum saevae memorem Iunonis ob iram; 5multa quoque et bello passus, dum conderet urbem, inferretque deos Latio, genus unde Latinum, Albanique patres, atque altae moenia Romae.
      </p>
      <h3>When is a game won or lost?</h3>
      <p>
        Arma virumque cano, Troiae qui primus ab oris Italiam, fato profugus, Laviniaque venit litora, multum ille et terris iactatus et alto vi superum saevae memorem Iunonis ob iram; 5multa quoque et bello passus, dum conderet urbem, inferretque deos Latio, genus unde Latinum, Albanique patres, atque altae moenia Romae.
      </p>
      <h3>How to instruct the player?</h3>
      <p>
        Arma virumque cano, Troiae qui primus ab oris Italiam, fato profugus, Laviniaque venit litora, multum ille et terris iactatus et alto vi superum saevae memorem Iunonis ob iram; 5multa quoque et bello passus, dum conderet urbem, inferretque deos Latio, genus unde Latinum, Albanique patres, atque altae moenia Romae.
      </p>
      <h3>Creating your own games</h3>
      <p>
        Arma virumque cano, Troiae qui primus ab oris Italiam, fato profugus, Laviniaque venit litora, multum ille et terris iactatus et alto vi superum saevae memorem Iunonis ob iram; 5multa quoque et bello passus, dum conderet urbem, inferretque deos Latio, genus unde Latinum, Albanique patres, atque altae moenia Romae.
      </p>
      <!-- - there are levels, there is a player, who controls some elements in the level, and there is nature, who controls the rest
      - the game is played in discrete time steps
      - at each time step, the player performs some action(s),
      and based on this nature determines the next state of the game
      - you instruct the player via an ASP program (with special predicates), see below
      - not everything in the level may be observable to the player
      - the player can keep and update a memory as time progresses

      # level generation
      - levels are generated by an ASP program
      - special predicates: at, setting, decorate
      - RANDINT(x,y) may be used, to express randomness
      - for example

      # visibility
      - expresses what parts of the level the player can observe at each time step
      - uses predicate observe

      # nature program
      - gets as input the state of the game (with at)
      - and the level settings that don't change (with setting)
      - and the player's move (with do)
      - and determines the next state of the world (with next, which will be renamed to at in next time step)
      - RANDINT(x,y) may be used, to express randomness
      - if there is no answer set, the state of the world doesn't change (give example)

      # winning conditions
      - gets as input the state of the game
      - and level settings
      - determines whether the game is won (with win)
      - or whether the game is lost (with lose)
      - or whether the game is neither won nor lost yet.

      # player program
      - gets as input the state of the game, observable to the player (with observe)
      - and the level settings that don't change (with setting)
      - and the player's memory (with memory)
      - determines the move(s) made in this game
      - determines the updates to the player's memory (with remember and forget; give example)
      - RANDINT(x,y) may be used, to express randomness -->

    </section>

    <section id="section-game-rules">
      <h3>Level generation <a href="javascript:void()" class="modal-link" data-open="modal-level-programs">&#xf05a;</a></h3>
      <p>
        This program expresses how levels are generated.
      </p>
      <div class="inline-controls" >
        <button onclick="lock_level_generation()" class="control-button" id="lock-button">&#x25CF; Lock</button>
        &nbsp;
        <button onclick="unlock_level_generation()" class="control-button" id="unlock-button" disabled>&#x25CB; Unlock</button>
      </div>
      <pre id="level_gen_program"></pre>

      <h3>Visibility <a href="javascript:void()" class="modal-link" data-open="modal-level-programs">&#xf05a;</a></h3>
      <p>
        This program expresses what the player can observe.
      </p>
      <div class="inline-controls" >
        <button onclick="lock_level_generation()" class="control-button" id="lock-button2">&#x25CF; Lock</button>
        &nbsp;
        <button onclick="unlock_level_generation()" class="control-button" id="unlock-button2" disabled>&#x25CB; Unlock</button>
      </div>
      <pre id="visibility_program"></pre>

      <h3>Nature's moves <a href="javascript:void()" class="modal-link" data-open="modal-natures-moves">&#xf05a;</a></h3>
      <p>
        This program expresses nature's moves&mdash;i.e.,
        how the state of the board changes as a result of
        the player's moves.
      </p>
      <pre id="nature_program"></pre>

      <h3>Winning conditions <a href="javascript:void()" class="modal-link" data-open="modal-winning-conditions">&#xf05a;</a></h3>
      <p>
        This program expresses when the game is won or lost.
      </p>
      <pre id="goal_program"></pre>
    </section>

    <section id="section-player-strategy">
      <h3>Player strategy <a href="javascript:void()" class="modal-link" data-open="modal-player-program">&#xf05a;</a></h3>
      <p>
        This program computes the player's move(s).
      </p>
      <pre id="player_move_program"></pre>
    </section>

    <section id="section-debug">
      <div id="level-editor">
        <h3>Level settings</h3>
        <pre id="level_settings"></pre>
        <h3>Level state</h3>
        <pre id="level_state"></pre>
        <button onclick="update_interface()" class="control-button">Update interface</button>
        <p>&nbsp;</p>
      </div>

      <h3>Game output</h3>
      <p>
        Below you will find, for each time step,
        what facts were fed into the player program,
        based on (i) the state of the game that is observable to the player,
        and (ii) the player's memory.
      </p>
      <!-- <input type="checkbox" id="verbose" name="verbose" value="Verbose" checked>
      <label for="verbose"> Verbose</label><br> -->
      <pre id="game-output" class="code"></pre>
      <!-- <h3>Clingo output</h3>
      <pre id="clingo-output" class="code"></pre> -->
      <!-- <h3>Reset</h3>
      <button onclick="reset_debugging()" class="control-button">Reset</button> -->
    </section>

  </main>

  <div class="modal" id="modal-level-programs">
    <div class="modal-dialog">
      <header class="modal-header">
        <button class="close-modal" aria-label="close modal" data-close>✕</button>
      </header>
      <div class="modal-content">
        <h3>Level generation &amp; visibility programs</h3>
        <p>asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf</p>
        <p>asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf</p>
        <p>asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf</p>
        <p>asdf</p>
      </div>
    </div>
  </div>

  <div class="modal" id="modal-natures-moves">
    <div class="modal-dialog">
      <header class="modal-header">
        <button class="close-modal" aria-label="close modal" data-close>✕</button>
      </header>
      <div class="modal-content">
        <h3>Nature's moves</h3>
        <p>asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf</p>
        <pre class="example-code">a :- not b.</pre>
        <p>asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf</p>
        <p>asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf</p>
        <p>asdf</p>
      </div>
    </div>
  </div>

  <div class="modal" id="modal-winning-conditions">
    <div class="modal-dialog">
      <header class="modal-header">
        <button class="close-modal" aria-label="close modal" data-close>✕</button>
      </header>
      <div class="modal-content">
        <h3>Winning conditions</h3>
        <p>asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf</p>
        <pre class="example-code">a :- b.</pre>
        <p>asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf</p>
        <p>asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf</p>
        <p>asdf</p>
      </div>
    </div>
  </div>

  <div class="modal" id="modal-player-program">
    <div class="modal-dialog">
      <header class="modal-header">
        <button class="close-modal" aria-label="close modal" data-close>✕</button>
      </header>
      <div class="modal-content">
        <h3>Player strategy</h3>
        <p>asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf</p>
        <pre class="example-code">woo :- foo, not bar.</pre>
        <p>asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf</p>
        <p>asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf</p>
        <p>asdf</p>
      </div>
    </div>
  </div>

  <script type="text/javascript" src="js/ace.js" charset="utf-8"></script>
  <script type="text/javascript" src="js/init.js" charset="utf-8"></script>
  <script type="text/javascript" src="js/clingo-module.js" charset="utf-8"></script>
  <script type="text/javascript" src="js/inputs.js" charset="utf-8"></script>
  <script type="text/javascript" src="js/modal.js" charset="utf-8"></script>
  <script type="text/javascript" src="js/control.js" charset="utf-8"></script>
  <script type="text/javascript" src="js/game.js" charset="utf-8"></script>
  <script type="text/javascript" src="js/grid-visual.js" charset="utf-8"></script>

</body>
</html>
